{"ast":null,"code":"var _jsxFileName = \"G:\\\\GitRepos\\\\ecommerce_app\\\\client\\\\src\\\\Pages\\\\login\\\\login.js\",\n    _s = $RefreshSig$();\n\nimport './login.css';\nimport Services from '../../api/apiCalls';\nimport { useEffect, useState } from 'react';\nimport bcrypt from 'bcryptjs';\nimport { Alert, Button } from 'react-bootstrap';\nimport AddProduct from '../addProduct/addProduct';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst authService = new Services();\nlet logOutVis = 'hidden';\nconst length = Number(process.env.REACT_APP_SESSION);\n\nconst Login = () => {\n  _s();\n\n  //login states\n  const [showMessage, setMessage] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(false);\n  const [loggedIn, setLoggedIn] = useState(false); //show logout button on refresh if logged in\n\n  useEffect(() => {\n    let user = sessionStorage.getItem('userEmail');\n\n    if (user !== null) {\n      logOutVis = 'Visible';\n    }\n  }); //Set logged in status\n\n  useEffect(() => {\n    let sessionID = sessionStorage.getItem('session');\n\n    if (sessionID) {\n      setLoggedIn(true);\n    } else {\n      setLoggedIn(false);\n    }\n  }, []); //login user\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const password = e.target.form[1].value;\n\n    try {\n      //send login request\n      const response = await authService.authUser({\n        username: e.target.form[0].value,\n        password: password\n      }); //check session id\n\n      if (response.session.length === length) {\n        //show messages\n        setMessage(true);\n        setErrorMessage(false); //store user\n\n        sessionStorage.setItem('session', response.session); //clear form\n\n        e.target.form[0].value = '';\n        e.target.form[1].value = ''; //set state\n\n        setLoggedIn(true);\n      }\n    } catch (err) {\n      setMessage(false);\n      setErrorMessage(true);\n    }\n  };\n\n  const handleLogOut = async () => {\n    const response = await authService.logout(sessionStorage.getItem(\"session\"));\n    console.log(response);\n    sessionStorage.setItem('session', '');\n    window.location.reload();\n  }; //If the user is not logged in show the login form\n\n\n  if (!loggedIn) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        show: errorMessage,\n        onClose: () => setErrorMessage(false),\n        dismissible: true,\n        children: \"Incorrect Login, Please Try Again\"\n      }, 'danger', false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"formBlock\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Sign In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Email address\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            className: \"form-control\",\n            placeholder: \"Enter email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            className: \"form-control\",\n            placeholder: \"Enter password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-grid\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-primary\",\n            onClick: handleSubmit,\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this); //User is logged in call the add product component\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"success\",\n        show: showMessage,\n        children: [/*#__PURE__*/_jsxDEV(Alert.Heading, {\n          children: \"Welcome\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please Use The Form Below To Add or Update Products\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this)]\n      }, \"success\", true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AddProduct, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"formBlock\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          id: \"btn\",\n          className: \"btn btn-primary\",\n          onClick: handleLogOut,\n          children: \"Log Out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this);\n  }\n};\n\n_s(Login, \"irwDjl6N40omyWXTTeUs1naH7f0=\");\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["Services","useEffect","useState","bcrypt","Alert","Button","AddProduct","authService","logOutVis","length","Number","process","env","REACT_APP_SESSION","Login","showMessage","setMessage","errorMessage","setErrorMessage","loggedIn","setLoggedIn","user","sessionStorage","getItem","sessionID","handleSubmit","e","preventDefault","password","target","form","value","response","authUser","username","session","setItem","err","handleLogOut","logout","console","log","window","location","reload"],"sources":["G:/GitRepos/ecommerce_app/client/src/Pages/login/login.js"],"sourcesContent":["import './login.css'\r\nimport Services from '../../api/apiCalls'\r\nimport { useEffect, useState } from 'react'\r\nimport bcrypt from 'bcryptjs'\r\nimport { Alert, Button } from 'react-bootstrap'\r\nimport AddProduct from '../addProduct/addProduct'\r\nconst authService = new Services()\r\nlet logOutVis = 'hidden'\r\nconst length = Number(process.env.REACT_APP_SESSION)\r\n\r\nconst Login = () => {\r\n  //login states\r\n  const [showMessage, setMessage] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState(false)\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n\r\n  //show logout button on refresh if logged in\r\n  useEffect(() => {\r\n    let user = sessionStorage.getItem('userEmail')\r\n    if (user !== null) {\r\n      logOutVis = 'Visible'\r\n    }\r\n  })\r\n\r\n  //Set logged in status\r\n  useEffect(() => {\r\n    let sessionID = sessionStorage.getItem('session')\r\n    if (sessionID) {\r\n      setLoggedIn(true)\r\n    } else {\r\n      setLoggedIn(false)\r\n    }\r\n\r\n  }, [])\r\n\r\n  //login user\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const password = e.target.form[1].value\r\n    try {\r\n      //send login request\r\n      const response = await authService.authUser({\r\n        username: e.target.form[0].value,\r\n        password: password,\r\n      })\r\n      //check session id\r\n      if (response.session.length === length) {\r\n        //show messages\r\n        setMessage(true)\r\n        setErrorMessage(false)\r\n        //store user\r\n        sessionStorage.setItem('session', response.session)\r\n        //clear form\r\n        e.target.form[0].value = ''\r\n        e.target.form[1].value = ''\r\n        //set state\r\n        setLoggedIn(true)\r\n      }\r\n    } catch (err) {\r\n      setMessage(false)\r\n      setErrorMessage(true)\r\n    }\r\n  }\r\n  const handleLogOut = async () => {\r\n    const response = await authService.logout(sessionStorage.getItem(\"session\"))\r\n    console.log(response)\r\n    sessionStorage.setItem('session', '')\r\n    window.location.reload()\r\n  }\r\n\r\n  //If the user is not logged in show the login form\r\n  if (!loggedIn) {\r\n    return (\r\n      <div>\r\n        <Alert key='danger'\r\n          variant='danger'\r\n          show={errorMessage}\r\n          onClose={() => setErrorMessage(false)}\r\n          dismissible>\r\n          Incorrect Login, Please Try Again\r\n        </Alert>\r\n        <form className=\"formBlock\">\r\n          <h3>Sign In</h3>\r\n          <div className=\"mb-3\">\r\n            <label>Email address</label>\r\n            <input\r\n              type=\"email\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter email\"\r\n            />\r\n          </div>\r\n          <div className=\"mb-3\">\r\n            <label>Password</label>\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter password\"\r\n            />\r\n          </div>\r\n          <div className=\"mb-3\">\r\n          </div>\r\n          <div className=\"d-grid\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-primary\"\r\n              onClick={handleSubmit}\r\n            >\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n      </div>\r\n\r\n    )\r\n    //User is logged in call the add product component\r\n  } else {\r\n    return (\r\n      <div >\r\n        <Alert key=\"success\" variant=\"success\" show={showMessage}>\r\n          <Alert.Heading>Welcome</Alert.Heading>\r\n          <p>Please Use The Form Below To Add or Update Products</p>\r\n        </Alert>\r\n\r\n        <AddProduct />\r\n        <div className='formBlock'>\r\n        <button\r\n          type=\"button\"\r\n          id=\"btn\"\r\n          className=\"btn btn-primary\"\r\n          onClick={handleLogOut}\r\n        >\r\n          Log Out\r\n        </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Login\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}