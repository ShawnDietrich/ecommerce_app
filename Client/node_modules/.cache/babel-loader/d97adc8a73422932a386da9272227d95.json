{"ast":null,"code":"import _regeneratorRuntime from \"G:\\\\GitRepos\\\\ecommerce_app\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"G:\\\\GitRepos\\\\ecommerce_app\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"G:\\\\GitRepos\\\\ecommerce_app\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"G:\\\\GitRepos\\\\ecommerce_app\\\\client\\\\src\\\\Pages\\\\login\\\\login.js\";\n\nimport './login.css';\nimport Services from '../../api/apiCalls';\nimport React, { useEffect, useState } from 'react';\nimport bcrypt from 'bcryptjs';\nimport { Alert, Button } from 'react-bootstrap';\nimport AddProduct from '../addProduct/addProduct';\nvar authService = new Services();\nvar logOutVis = 'hidden';\nvar length = Number(process.env.REACT_APP_SESSION);\n\nvar Login = function Login() {\n  //login states\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showMessage = _useState2[0],\n      setMessage = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errorMessage = _useState4[0],\n      setErrorMessage = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loggedIn = _useState6[0],\n      setLoggedIn = _useState6[1]; //show logout button on refresh if logged in\n\n\n  useEffect(function () {\n    var user = sessionStorage.getItem('userEmail');\n\n    if (user !== null) {\n      logOutVis = 'Visible';\n    }\n  }); //Set logged in status\n\n  useEffect(function () {\n    var sessionID = sessionStorage.getItem('session');\n\n    if (sessionID) {\n      setLoggedIn(true);\n    } else {\n      setLoggedIn(false);\n    }\n  }, []); //login user\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var password, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              password = e.target.form[1].value;\n              _context.prev = 2;\n              _context.next = 5;\n              return authService.authUser({\n                username: e.target.form[0].value,\n                password: password\n              });\n\n            case 5:\n              response = _context.sent;\n\n              //check session id\n              if (response.session.length === length) {\n                //show messages\n                setMessage(true);\n                setErrorMessage(false); //store user\n\n                sessionStorage.setItem('session', response.session); //clear form\n\n                e.target.form[0].value = '';\n                e.target.form[1].value = ''; //set state\n\n                setLoggedIn(true);\n              }\n\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](2);\n              setMessage(false);\n              setErrorMessage(true);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 9]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleLogOut = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return authService.logout(sessionStorage.getItem(\"session\"));\n\n            case 2:\n              response = _context2.sent;\n              console.log(response);\n              sessionStorage.setItem('session', '');\n              window.location.reload();\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleLogOut() {\n      return _ref2.apply(this, arguments);\n    };\n  }(); //If the user is not logged in show the login form\n\n\n  if (!loggedIn) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Alert, {\n      key: \"danger\",\n      variant: \"danger\",\n      show: errorMessage,\n      onClose: function onClose() {\n        return setErrorMessage(false);\n      },\n      dismissible: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }\n    }, \"Incorrect Login, Please Try Again\"), /*#__PURE__*/React.createElement(\"form\", {\n      className: \"formBlock\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }\n    }, \"Sign In\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mb-3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 13\n      }\n    }, \"Email address\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"email\",\n      className: \"form-control\",\n      placeholder: \"Enter email\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mb-3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      className: \"form-control\",\n      placeholder: \"Enter password\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mb-3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-grid\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary\",\n      onClick: handleSubmit,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }\n    }, \"Submit\")))); //User is logged in call the add product component\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Alert, {\n      key: \"success\",\n      variant: \"success\",\n      show: showMessage,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Alert.Heading, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }\n    }, \"Welcome\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }\n    }, \"Please Use The Form Below To Add or Update Products\")), /*#__PURE__*/React.createElement(AddProduct, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"formBlock\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      id: \"btn\",\n      className: \"btn btn-primary\",\n      onClick: handleLogOut,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }\n    }, \"Log Out\")));\n  }\n};\n\nexport default Login;","map":{"version":3,"names":["Services","React","useEffect","useState","bcrypt","Alert","Button","AddProduct","authService","logOutVis","length","Number","process","env","REACT_APP_SESSION","Login","showMessage","setMessage","errorMessage","setErrorMessage","loggedIn","setLoggedIn","user","sessionStorage","getItem","sessionID","handleSubmit","e","preventDefault","password","target","form","value","authUser","username","response","session","setItem","handleLogOut","logout","console","log","window","location","reload"],"sources":["G:/GitRepos/ecommerce_app/client/src/Pages/login/login.js"],"sourcesContent":["import './login.css'\r\nimport Services from '../../api/apiCalls'\r\nimport React, { useEffect, useState } from 'react'\r\nimport bcrypt from 'bcryptjs'\r\nimport { Alert, Button } from 'react-bootstrap'\r\nimport AddProduct from '../addProduct/addProduct'\r\nconst authService = new Services()\r\nlet logOutVis = 'hidden'\r\nconst length = Number(process.env.REACT_APP_SESSION)\r\n\r\nconst Login = () => {\r\n  //login states\r\n  const [showMessage, setMessage] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState(false)\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n\r\n  //show logout button on refresh if logged in\r\n  useEffect(() => {\r\n    let user = sessionStorage.getItem('userEmail')\r\n    if (user !== null) {\r\n      logOutVis = 'Visible'\r\n    }\r\n  })\r\n\r\n  //Set logged in status\r\n  useEffect(() => {\r\n    let sessionID = sessionStorage.getItem('session')\r\n    if (sessionID) {\r\n      setLoggedIn(true)\r\n    } else {\r\n      setLoggedIn(false)\r\n    }\r\n\r\n  }, [])\r\n\r\n  //login user\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const password = e.target.form[1].value\r\n    try {\r\n      //send login request\r\n      const response = await authService.authUser({\r\n        username: e.target.form[0].value,\r\n        password: password,\r\n      })\r\n      //check session id\r\n      if (response.session.length === length) {\r\n        //show messages\r\n        setMessage(true)\r\n        setErrorMessage(false)\r\n        //store user\r\n        sessionStorage.setItem('session', response.session)\r\n        //clear form\r\n        e.target.form[0].value = ''\r\n        e.target.form[1].value = ''\r\n        //set state\r\n        setLoggedIn(true)\r\n      }\r\n    } catch (err) {\r\n      setMessage(false)\r\n      setErrorMessage(true)\r\n    }\r\n  }\r\n  const handleLogOut = async () => {\r\n    const response = await authService.logout(sessionStorage.getItem(\"session\"))\r\n    console.log(response)\r\n    sessionStorage.setItem('session', '')\r\n    window.location.reload()\r\n  }\r\n\r\n  //If the user is not logged in show the login form\r\n  if (!loggedIn) {\r\n    return (\r\n      <div>\r\n        <Alert key='danger'\r\n          variant='danger'\r\n          show={errorMessage}\r\n          onClose={() => setErrorMessage(false)}\r\n          dismissible>\r\n          Incorrect Login, Please Try Again\r\n        </Alert>\r\n        <form className=\"formBlock\">\r\n          <h3>Sign In</h3>\r\n          <div className=\"mb-3\">\r\n            <label>Email address</label>\r\n            <input\r\n              type=\"email\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter email\"\r\n            />\r\n          </div>\r\n          <div className=\"mb-3\">\r\n            <label>Password</label>\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter password\"\r\n            />\r\n          </div>\r\n          <div className=\"mb-3\">\r\n          </div>\r\n          <div className=\"d-grid\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-primary\"\r\n              onClick={handleSubmit}\r\n            >\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n      </div>\r\n\r\n    )\r\n    //User is logged in call the add product component\r\n  } else {\r\n    return (\r\n      <div >\r\n        <Alert key=\"success\" variant=\"success\" show={showMessage}>\r\n          <Alert.Heading>Welcome</Alert.Heading>\r\n          <p>Please Use The Form Below To Add or Update Products</p>\r\n        </Alert>\r\n\r\n        <AddProduct />\r\n        <div className='formBlock'>\r\n        <button\r\n          type=\"button\"\r\n          id=\"btn\"\r\n          className=\"btn btn-primary\"\r\n          onClick={handleLogOut}\r\n        >\r\n          Log Out\r\n        </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Login\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}